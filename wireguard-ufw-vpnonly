# This installs ufw and wireguard, configures so only local traffic and traffic over the VPN is allowed via port 51820.


apt update && apt upgrade -y

# Bullseye
apt install openresolv ufw wireguard curl  -y

# Buster 
# echo 'deb http://deb.debian.org/debian buster-backports main contrib non-free' > /etc/apt/sources.list.d/buster-backports.list
# apt update
# apt install resolvconf ufw wireguard curl -y

ufw reset
ufw enable
ufw allow in to 192.168.1.0/24 # Local network access. Restrict for greater security
ufw allow out to 192.168.1.0/24 # Local network access. Restrict for greater security
ufw allow out to any port 51820 proto udp # Allow Wireguard on 51820. You can do specific IP here.
ufw default deny outgoing # Deny all out
ufw default deny incoming # Deny all in
ufw allow out on wg0 from any to any # Allow out on wg0 network interface (VPN only)
#ufw allow in on wg0 from any to any # If enabling external access through the vpn
ufw reload

# curl ipinfo.io # Test VPN
